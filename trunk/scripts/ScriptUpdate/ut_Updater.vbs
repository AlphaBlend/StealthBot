Class ut_Updater	Private p_showXml		Private UPDATE_SERVER	Private p_initialized, p_scriptObject		Public Sub Class_Initialize()		UPDATE_SERVER = "http://stealthbotdev.info/plugins/update/"		p_initialized = True				'// For debugging		p_showXml = True			End Sub			'// Public Functions		Public Function FetchCategories()				'<ScriptUpdate>		'	<Request Action="FetchCategories" />		'</ScriptUpdate>				Dim xmlWriter				Set xmlWriter = New cXMLTextWriter		With xmlWriter			Call .WriteStartDocument("ScriptUpdate")				Call .WriteStartElement("Request")				Call .WriteAttributeString("Action", "FetchCategories")				Call .WriteEndElement() '// Request			Call .WriteEndDocument()		End With				'// send the request		Set FetchCategories = Send(xmlWriter.XMLObject)				'// cleanup		Set xmlWriter = Nothing					End Function	Public Function FetchSBScriptsInCategory(categoryID)			'<ScriptUpdate>		'	<Request Action="FetchSBScriptsInCategory">		'		<Category CategoryID="6" />		'	</Request>		'</ScriptUpdate>				Dim xmlWriter				Set xmlWriter = New cXMLTextWriter		With xmlWriter			Call .WriteStartDocument("ScriptUpdate")				Call .WriteStartElement("Request")				Call .WriteAttributeString("Action", "FetchSBScriptsInCategory")					Call .WriteStartElement("Category")					Call .WriteAttributeString("CategoryID", categoryID)					Call .WriteEndElement() '// Category				Call .WriteEndElement() '// Request			Call .WriteEndDocument()		End With		'// send the request		Set FetchSBScriptsInCategory = Send(xmlWriter.XMLObject)				'// cleanup		Set xmlWriter = Nothing			End Function	Public Function CheckForUpdates()		'<ScriptUpdate>		'	<Request Action="CheckForUpdates">		'		<SBScripts>		'			<SBScript Name="utDatabase" VersionMajor="0" VersionMinor="3" VersionRevision="0" />		'			<SBScript Name="ScriptUpdate" VersionMajor="0" VersionMinor="1" VersionRevision="0" />		'		</SBScripts>		'	</Request>		'</ScriptUpdate>			Dim xmlWriter, scriptObject				Set xmlWriter = New cXMLTextWriter		With xmlWriter			Call .WriteStartDocument("ScriptUpdate")				Call .WriteStartElement("Request")				Call .WriteAttributeString("Action", "CheckForUpdates")					Call .WriteStartElement("SBScripts")												For Each scriptObject In Scripts							Call .WriteStartElement("SBScript")							Call .WriteAttributeString("Name", scriptObject.Script("Name"))							Call .WriteAttributeString("VersionMajor", scriptObject.Script("Major"))							Call .WriteAttributeString("VersionMinor", scriptObject.Script("Minor"))							Call .WriteAttributeString("VersionRevision", scriptObject.Script("Revision"))							Call .WriteEndElement() '// SBScript						Next												Call .WriteEndElement() '// SBScripts				Call .WriteEndElement() '// Request			Call .WriteEndDocument()		End With		'// send the request		Set CheckForUpdates = Send(xmlWriter.XMLObject)				'// cleanup		Set xmlWriter = Nothing	End Function	Public Function SearchScripts(categoryID, searchString, showLibraries)			'<ScriptUpdate>		'	<Request Action="SearchScripts">		'		<Search Text="Awesome" />		'	</Request>		'</ScriptUpdate>				Dim xmlWriter				Set xmlWriter = New cXMLTextWriter		With xmlWriter			Call .WriteStartDocument("ScriptUpdate")				Call .WriteStartElement("Request")				Call .WriteAttributeString("Action", "SearchScripts")					Call .WriteStartElement("Search")					If categoryID > 0 Then						Call .WriteAttributeString("CategoryID", categoryID)					End If					Call .WriteAttributeString("ShowLibraries", showLibraries)					Call .WriteAttributeString("Text", searchString)					Call .WriteEndElement() '// Search				Call .WriteEndElement() '// Request			Call .WriteEndDocument()		End With		'// send the request		Set SearchScripts = Send(xmlWriter.XMLObject)				'// cleanup		Set xmlWriter = Nothing			End Function		Public Function ScriptInfo(scriptObjectArray)				'<ScriptUpdate>		'	<Request Action="ScriptInfo">		'		<SBScripts>		'			<SBScript Name="SBScriptUpdate" />		'		</SBScripts>		'	</Request>		'</ScriptUpdate>						Dim xmlWriter				Set xmlWriter = New cXMLTextWriter		With xmlWriter			Call .WriteStartDocument("ScriptUpdate")				Call .WriteStartElement("Request")				Call .WriteAttributeString("Action", "ScriptInfo")					Call .WriteStartElement("SBScripts")						For Each scriptObject In scriptObjectArray							Call .WriteStartElement("SBScript")								Call .WriteAttributeString("Name", .Script("Name"))							Call .WriteEndElement() '// SBScript						Next					Call .WriteEndElement() '// SBScripts				Call .WriteEndElement() '// Request			Call .WriteEndDocument()		End With		'// send the request		Set ScriptInfo = Send(xmlWriter.XMLObject)				'// cleanup		Set xmlWriter = Nothing	End Function					Public Function DownloadScript(scriptName)		End Function				'// Private Functions	Private Function Send(requestXml)		Dim responseXml, xmlhttp		Set xmlhttp = CreateObject("MSXML2.XMLHTTP.4.0")		Set responseXml = CreateObject("MSXML2.DOMDocument.4.0")		'// debugging		If p_showXml Then			AddChat Color.CSS("GoldenRod"), "-=[ XML REQUEST ]=-"			AddChat Color.CSS("Lavender"), "<?xml version=""1.0""?>" & requestXml.Xml		End If						Call xmlhttp.Open("POST", UPDATE_SERVER, False)				Call xmlhttp.SetRequestHeader("Content-type", "application/x-www-form-urlencoded")		Call xmlhttp.Send("xml=" & Escape("<?xml version=""1.0""?>" & requestXml.Xml))				responseXml.ASync = False				'// debugging		If p_showXml Then			AddChat Color.CSS("GoldenRod"), "-=[ XML RESPONSE ]=-"			AddChat Color.CSS("LightSlateGray"), xmlhttp.ResponseText		End If				Call responseXml.Load(xmlhttp.ResponseXML)		Set xmlhttp = Nothing		Set Send = responseXml		End Function	End Class