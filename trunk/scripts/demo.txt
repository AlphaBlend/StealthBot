#include "\demo\frm.txt"
#include "\demo\sck.txt"

Function Name()

   Name = "Demo"

End Function

Sub Event_Load()

   CreateObj "Winsock", "sck"
   
   With sck
      .RemoteHost = "uswest.battle.net"
      .RemotePort = 6112
      .Connect
   End With

   CreateObj "LongTimer", "LTimer"

   With LTimer
      .Interval = 60
      .Enabled = True
   End With

   CreateObj "Form", "frm"

   frm.Show

End Sub

Sub LTimer_Timer()

   AddChat vbBlue, "LTimer_Timer()"

   frm.Show

End Sub

Sub Event_PacketReceived(Protocol, ID, Length, Data)
   
   If (Protocol = "BNCS") Then
      If (ID = &H65) Then
         AddChat vbYellow, "RECEIVED BNCS FRIENDS LIST"
      End If
   End If

End Sub

Sub Event_PacketSent(Protocol, ID, Length, Data)

   If (Protocol = "BNCS") Then
      If (ID = &H65) Then
         AddChat vbYellow, "SENT BNCS FRIENDS LIST REQUEST"
      End If
   End If

End Sub

Sub TestDemo()

   AddChat vbBlue, "TestDemo()"

End Sub

