#include "\demo\frm.txt"
#include "\demo\sck.txt"

' // store script data
Script("Name") = "Demo"
Script("Author") = "Eric[nK]"
Script("Major") = 1
Script("Minor") = 0
Script("Revision") = 1

' // create instance of demo class
Set cls = New CDemoClass

Sub Event_Load()

   ' // create Winsock object
   CreateObj "Winsock", "sck"
   
   ' // set Winsock object properties
   With sck
      .RemoteHost = "uswest.battle.net"
      .RemotePort = 6112
      .Connect
   End With
 
   ' // create LongTimer object
   CreateObj "LongTimer", "LTimer"

   ' // set LongTimer object properties
   With LTimer
      .Interval = 60
      .Enabled = True
   End With

   ' // create Form object
   CreateObj "Form", "frm"

   ' // create Menu objects
   CreateObj "Menu", "mnu"
   CreateObj "Menu", "submnu"

   ' // set submnu as child of mnu
   submnu.Parent = mnu

   ' // set menu captions
   mnu.Caption = "menu"
   submnu.Caption = "submenu"

   ' // show form
   frm.Show

End Sub

' LTimer event sub
Sub LTimer_Timer()

   AddChat vbBlue, "LTimer_Timer()"

End Sub

Sub Event_PacketReceived(Protocol, ID, Length, Data)
   
   If (Protocol = "BNCS") Then
      If (ID = &H65) Then
         AddChat vbYellow, "RECEIVED BNCS FRIENDS LIST"
      End If
   End If

End Sub

Sub Event_PacketSent(Protocol, ID, Length, Data)

   If (Protocol = "BNCS") Then
      If (ID = &H65) Then
         AddChat vbYellow, "SENT BNCS FRIENDS LIST REQUEST"
      End If
   End If

End Sub

Sub submnu_Click()

   AddChat vbBlue, "submnu_Click()"

End Sub

Sub TestDemo()

   AddChat vbBlue, "TestDemo()"

End Sub

' // demo class module
Class CDemoClass

   ' // demo class default constructor
   Sub Class_Initialize()
      MsgBox Script("Name")
   End Sub

End Class